"use strict";(self.webpackChunkFreshCartEcommerce=self.webpackChunkFreshCartEcommerce||[]).push([[177],{5177:(g,m,o)=>{o.r(m),o.d(m,{PaymentComponent:()=>p});var _=o(6814),n=o(95),t=o(4769),h=o(2623),u=o(1120);function C(e,d){1&e&&(t.TgZ(0,"p"),t._uU(1," Required "),t.qZA())}function r(e,d){1&e&&(t.TgZ(0,"p"),t._uU(1," Only Egyptian Phone Number "),t.qZA())}function l(e,d){if(1&e&&(t.TgZ(0,"div",11),t.YNc(1,C,2,0,"p",12),t.YNc(2,r,2,0,"p",12),t.qZA()),2&e){const s=t.oxw();let a,i;t.xp6(1),t.Q6J("ngIf",null==(a=s.checkForm.get("phone"))?null:a.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(i=s.checkForm.get("phone"))?null:i.getError("pattern"))}}let p=(()=>{class e{constructor(s,a,i){this._FormBuilder=s,this._CartService=a,this._ActivatedRoute=i,this.cartId="",this.checkForm=this._FormBuilder.group({details:[""],phone:["",[n.kI.required,n.kI.pattern(/^01[0125][0-9]{8}$/gm)]],city:[""]})}ngOnInit(){this._ActivatedRoute.paramMap.subscribe({next:s=>{s.get("id"),this.cartId=s.get("id")}})}handleForm(){this._CartService.checkOut(this.cartId,this.checkForm.value).subscribe({next:a=>{"success"===a.status&&window.open(a.session.url,"_self")}})}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(n.qu),t.Y36(h.N),t.Y36(u.gz))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-payment"]],standalone:!0,features:[t.jDz],decls:18,vars:2,consts:[[1,"w-75","mx-auto","rounded","shadow","p-3","bg-main-light","marginY",3,"formGroup","ngSubmit"],[1,"text-center","py-3","text-main","fw-bold"],[1,"formItem"],["for","details"],["type","text","formControlName","details","id","details",1,"form-control","my-3"],["for","city"],["type","text","formControlName","city","id","city",1,"form-control","my-3"],["for","phone"],["formControlName","phone","name","phone","id","phone","type","tel",1,"form-control","my-2"],["class","alert alert-danger",4,"ngIf"],[1,"main-btn",3,"click"],[1,"alert","alert-danger"],[4,"ngIf"]],template:function(a,i){if(1&a&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return i.handleForm()}),t.TgZ(1,"h2",1),t._uU(2,"Fill Your Details"),t.qZA(),t.TgZ(3,"div",2)(4,"label",3),t._uU(5,"Details :"),t.qZA(),t._UZ(6,"input",4),t.qZA(),t.TgZ(7,"div",2)(8,"label",5),t._uU(9,"City :"),t.qZA(),t._UZ(10,"input",6),t.qZA(),t.TgZ(11,"div",2)(12,"label",7),t._uU(13,"Phone :"),t.qZA(),t._UZ(14,"input",8),t.YNc(15,l,3,2,"div",9),t.qZA(),t.TgZ(16,"button",10),t.NdJ("click",function(){return i.handleForm()}),t._uU(17,"CheckOut"),t.qZA()()),2&a){let c;t.Q6J("formGroup",i.checkForm),t.xp6(15),t.Q6J("ngIf",((null==(c=i.checkForm.get("phone"))?null:c.touched)||(null==(c=i.checkForm.get("phone"))?null:c.value.length)>0)&&(null==(c=i.checkForm.get("phone"))?null:c.errors))}},dependencies:[_.ez,_.O5,n.UX,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u]})}return e})()},2623:(g,m,o)=>{o.d(m,{N:()=>h});var _=o(5619),n=o(4769),t=o(9862);let h=(()=>{class u{constructor(r){this._HttpClient=r,this.baseUrl="https://ecommerce.routemisr.com/api/v1/",this.cartItemNumber=new _.X(0)}addToCart(r){return this._HttpClient.post(this.baseUrl+"cart",{productId:r})}getUserCart(){return this._HttpClient.get(this.baseUrl+"cart")}removeFromCart(r){return this._HttpClient.delete(this.baseUrl+`cart/${r}`)}updateCartCount(r,l){return this._HttpClient.put(this.baseUrl+`cart/${r}`,{count:l})}clearFromCart(){return this._HttpClient.delete(this.baseUrl+"cart")}getAllOrders(){return this._HttpClient.get(this.baseUrl+"orders")}checkOut(r,l){return this._HttpClient.post(this.baseUrl+`orders/checkout-session/${r}?url=https://ecommerce-website-mohamed-mosad.vercel.app`,{shippingAddress:l})}getCount(){this.getUserCart().subscribe({next:r=>{const l=r.data.products;let p=0;for(let e=0;e<l.length;e++)p+=l[e].count;this.cartItemNumber.next(p)}})}static#t=this.\u0275fac=function(l){return new(l||u)(n.LFG(t.eN))};static#e=this.\u0275prov=n.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()}}]);